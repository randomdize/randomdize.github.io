<!DOCTYPE html>
<html>
    <head><meta name="generator" content="Hexo 3.8.0">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="about:blank">
        <!--        <link href="https://fonts.googleapis.com/css?family=Noto+Serif+TC" rel="stylesheet">-->
        <link rel="stylesheet" href="/style.css">
        <title>如何在 Arduino 將 float, double 寫入 EEPROM - Code Apprentice</title>
   </head>
    <body>
        <header>
            <h1><a href="/">Code Apprentice</a></h1>
            <h3><a href="/">Blog</a> <a href="/about/">About</a></h3>
        </header>
        <article>
    <header>
        <h1>如何在 Arduino 將 float, double 寫入 EEPROM</h1>
        <time>2017-11-09</time>
    </header>
    <p></p><p>最近被問到要如何將浮點數存到 EEPROM，由於 EEPROM 一次只能存 1 byte.<br>所以實際上的問題應該是說如何將 4 bytes(float) 或是 8 bytes(double) 的資料型態每次 1 byte 存進 EEPROM。<br>第一直覺當然是使用 bitshift operator 來做，畢竟要切 byte 最直覺的方式就是透過 bitshifting 來切。不過 c/c++ 並不能做 floating-point shifting。<br>上網查了一下發現可以用 c union 來做，實際上做了也發現這樣的做法直觀容易多了。</p>
<p>在 c 中 union 就像是 struct 一樣，只不過其中的所有成員都是使用同一塊記憶體區域。在特殊情況下這似乎符合這次的需求：「將 float 或 double 用 byte 方式呈現。」</p>
<pre><code>union eDouble {
    double dValue;
    byte[8] bValue;
}
</code></pre><p>這樣設計將兩者對齊後就可以透過 eDouble.bValue[] 來一次存取一個 byte 了。  </p>
<p>挺有趣</p>
<p></p>
</article>

    </body>
</html>
